
{
  "entities": {
    "userProfile": {
      "title": "User Profile",
      "description": "Represents a user's public profile information.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the user's profile picture."
        },
        "credits": {
            "type": "number",
            "description": "The user's current credit balance."
        },
        "planId": {
            "type": "string",
            "enum": ["free", "essential", "pro"],
            "description": "The ID of the user's subscription plan."
        },
        "creditResetDate": {
            "type": "string",
            "format": "date-time",
            "description": "The date when the user's credits will be reset or replenished."
        },
        "stripeCustomerId": {
            "type": "string",
            "description": "The user's unique customer ID in Stripe."
        },
        "autoRechargeEnabled": {
          "type": "boolean",
          "description": "Indicates if auto-recharge is enabled for the user."
        },
        "rechargeThreshold": {
          "type": "number",
          "description": "The credit balance threshold in dollars that triggers an auto-recharge."
        },
        "rechargeAmount": {
          "type": "number",
          "description": "The amount in dollars to automatically recharge when the threshold is met."
        }
      },
      "required": ["displayName", "email"]
    },
    "agent": {
      "title": "Agent",
      "description": "Represents an AI agent workspace.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the agent."
        },
        "description": {
          "type": "string",
          "description": "A brief description of the agent's purpose."
        },
        "goals": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "A list of goals for the agent."
        },
        "temperature": {
          "type": "number",
          "description": "Controls the creativity of the agent's responses. 0 is deterministic, 1 is highly creative."
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user who owns this agent."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the agent was created."
        },
        "rateLimiting": {
          "type": "object",
          "description": "Configuration for rate limiting user interactions.",
          "properties": {
            "maxMessages": {
              "type": "number",
              "description": "The maximum number of messages a user can send within the timeframe."
            },
            "timeframe": {
              "type": "number",
              "description": "The duration of the time window in seconds."
            },
            "limitExceededMessage": {
              "type": "string",
              "description": "The message to display when the rate limit is exceeded."
            }
          }
        },
        "welcomeMessage": {
          "type": "string",
          "description": "The initial message the agent displays to the user."
        },
        "inCallWelcomeMessage": {
          "type": "string",
          "description": "The initial spoken message the agent uses at the start of a call."
        },
        "isWelcomeMessageEnabled": {
          "type": "boolean",
          "description": "Determines if the welcome message is active."
        },
        "isDisplayNameEnabled": {
            "type": "boolean",
            "description": "Determines if the display name is shown in the chat widget."
        },
        "logoUrl": {
          "type": "string",
          "format": "uri",
          "description": "The URL of the agent's logo."
        },
        "themeColor": {
          "type": "string",
          "description": "The primary accent color for the chat widget."
        },
        "agentVoice": {
          "type": "string",
          "description": "The pre-built voice for the agent during calls."
        },
        "orbColors": {
            "type": "object",
            "description": "Custom colors for the in-call orb animation.",
            "properties": {
                "bg": { "type": "string" },
                "c1": { "type": "string" },
                "c2": { "type": "string" },
                "c3": { "type": "string" }
            }
        },
        "emailSignature": {
            "type": "string",
            "description": "The signature to be appended to all emails sent by the agent."
        },
        "handoffEmail": {
            "type": "string",
            "format": "email",
            "description": "Email address to forward to for human handoff."
        },
        "dataRetentionPolicy": {
            "type": "string",
            "enum": ["30", "90", "365", "forever"],
            "description": "How long to retain conversation data."
        },
        "anonymizeData": {
            "type": "boolean",
            "description": "Whether to anonymize visitor data."
        }
      },
      "required": ["name", "userId", "createdAt"]
    },
    "agentIndex": {
      "title": "Agent Index",
      "description": "A top-level collection for efficiently looking up an agent's owner.",
      "type": "object",
      "properties": {
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns the agent."
        }
      },
      "required": ["ownerId"]
    },
    "agentText": {
      "title": "Agent Text Source",
      "description": "A text-based knowledge source for an agent.",
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "The title of the text source."
        },
        "content": {
          "type": "string",
          "description": "The full content of the text source."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the text source was created."
        }
      },
      "required": ["title", "content", "createdAt"]
    },
    "agentFile": {
      "title": "Agent File Source",
      "description": "A file-based knowledge source for an agent.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the file."
        },
        "type": {
          "type": "string",
          "description": "The MIME type of the file."
        },
        "size": {
          "type": "number",
          "description": "The size of the file in bytes."
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "The public URL to access the file."
        },
        "storagePath": {
          "type": "string",
          "description": "The path to the file in the storage bucket."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the file was uploaded."
        },
        "extractedText": {
          "type": "string",
          "description": "The extracted text content of the file."
        }
      },
      "required": ["name", "type", "size", "url", "storagePath", "createdAt"]
    },
    "workflowDefinition": {
      "title": "Workflow Definition",
      "description": "Defines the structure and blocks of an agent workflow.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the workflow."
        },
        "status": {
          "type": "string",
          "description": "The activation status of the workflow.",
          "enum": ["enabled", "disabled"]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the workflow was created."
        },
        "lastModified": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the workflow was last modified."
        },
        "blocks": {
          "type": "array",
          "description": "An ordered list of blocks that make up the workflow.",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string"
              },
              "type": {
                "type": "string"
              },
              "params": {
                "type": "object"
              }
            },
            "required": ["id", "type", "params"]
          }
        }
      },
      "required": ["name", "createdAt"]
    },
    "chatSession": {
      "title": "Chat Session",
      "description": "Represents a single conversation session with an agent.",
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "A title for the conversation, generated from the first user message."
        },
        "lastMessageSnippet": {
          "type": "string",
          "description": "A short preview of the last message in the conversation."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the first message in the session."
        },
        "lastActivity": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of the last message in the session."
        },
        "lastLeadAnalysisAt": {
            "type": "string",
            "format": "date-time",
            "description": "The timestamp when this chat session was last analyzed for lead generation."
        },
        "visitorInfo": {
          "type": "object",
          "properties": {
            "ip": { "type": ["string", "null"] },
            "userAgent": { "type": ["string", "null"] },
            "location": {
              "type": "object",
              "properties": {
                "city": { "type": ["string", "null"] },
                "region": { "type": ["string", "null"] },
                "country": { "type": ["string", "null"] }
              }
            },
            "browser": {
              "type": "object",
              "properties": {
                "name": { "type": ["string", "null"] },
                "version": { "type": ["string", "null"] }
              }
            },
            "os": {
              "type": "object",
              "properties": {
                "name": { "type": ["string", "null"] },
                "version": { "type": ["string", "null"] }
              }
            },
            "device": {
              "type": "object",
              "properties": {
                "vendor": { "type": ["string", "null"] },
                "model": { "type": ["string", "null"] },
                "type": { "type": ["string", "null"] }
              }
            }
          }
        }
      },
      "required": ["title", "createdAt", "lastActivity"]
    },
    "chatMessage": {
      "title": "Chat Message",
      "description": "Represents a single message within a chat session.",
      "type": "object",
      "properties": {
        "sender": {
          "type": "string",
          "enum": ["user", "agent"]
        },
        "text": {
          "type": "string",
          "description": "The content of the message."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["sender", "text", "timestamp"]
    },
    "lead": {
      "title": "Lead",
      "description": "Represents a potential customer lead captured from a conversation.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the lead."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The email address of the lead."
        },
        "phone": {
          "type": "string",
          "description": "The phone number of the lead."
        },
        "summary": {
          "type": "string",
          "description": "A brief summary of the lead's inquiry."
        },
        "sessionId": {
          "type": "string",
          "description": "The ID of the chat session where the lead was captured."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the lead was created."
        },
        "source": {
          "type": "string",
          "enum": ["Widget", "Email", "Phone"],
          "description": "The source channel where the lead was captured."
        }
      }
    },
    "emailSession": {
        "title": "Email Session",
        "description": "Represents a single email conversation thread with an agent.",
        "type": "object",
        "properties": {
            "subject": {
                "type": "string",
                "description": "The subject line of the email thread."
            },
            "participants": {
                "type": "array",
                "items": {
                    "type": "string",
                    "format": "email"
                },
                "description": "A list of email addresses participating in the conversation."
            },
            "lastActivity": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp of the last message in the thread."
            }
        },
        "required": ["subject", "participants", "lastActivity"]
    },
    "emailMessage": {
        "title": "Email Message",
        "description": "Represents a single email within a conversation thread.",
        "type": "object",
        "properties": {
            "messageId": {
                "type": "string",
                "description": "The unique Message-ID of the email."
            },
            "sender": {
                "type": "string",
                "format": "email",
                "description": "The email address of the sender."
            },
            "text": {
                "type": "string",
                "description": "The plain text content of the email."
            },
            "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "The timestamp when the email was received or sent."
            }
        },
        "required": ["messageId", "sender", "text", "timestamp"]
    },
    "interactionLog": {
        "title": "Interaction Log",
        "description": "A log of a complete interaction with an agent.",
        "type": "object",
        "properties": {
            "title": { "type": "string" },
            "origin": { "type": "string", "enum": ["Chat", "Email", "In-Call", "Phone"] },
            "status": { "type": "string", "enum": ["success", "error", "in-progress"] },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["title", "origin", "status", "timestamp"]
    },
    "logStep": {
        "title": "Log Step",
        "description": "A detailed step within a larger interaction log.",
        "type": "object",
        "properties": {
            "description": { "type": "string" },
            "timestamp": { "type": "string", "format": "date-time" },
            "metadata": { "type": "object" }
        },
        "required": ["description", "timestamp"]
    },
    "configurationLog": {
        "title": "Configuration Log",
        "description": "A log of a configuration change made to an agent.",
        "type": "object",
        "properties": {
            "title": { "type": "string" },
            "description": { "type": "string" },
            "timestamp": { "type": "string", "format": "date-time" },
            "actor": { "type": "string", "description": "The user ID of the person who made the change." }
        },
        "required": ["title", "description", "timestamp", "actor"]
    }
  },
  "auth": {
    "providers": ["email", "google.com"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/userProfile"
      },
      "description": "Stores public profile information for each user."
    },
    "/users/{userId}/agents/{agentId}": {
      "schema": {
        "$ref": "#/entities/agent"
      },
      "description": "Stores the agents created by a specific user."
    },
    "/agentIndex/{agentId}": {
      "schema": {
        "$ref": "#/entities/agentIndex"
      },
      "description": "A top-level index for fast, cost-effective lookups of an agent's owner."
    },
    "/users/{userId}/agents/{agentId}/texts/{textId}": {
      "schema": {
        "$ref": "#/entities/agentText"
      },
      "description": "Stores text-based knowledge sources for a specific agent."
    },
    "/users/{userId}/agents/{agentId}/files/{fileId}": {
      "schema": {
        "$ref": "#/entities/agentFile"
      },
      "description": "Stores file-based knowledge sources for a specific agent."
    },
    "/users/{userId}/agents/{agentId}/workflows/{workflowId}": {
      "schema": {
        "$ref": "#/entities/workflowDefinition"
      },
      "description": "Stores the workflow definitions for a specific agent."
    },
    "/users/{userId}/agents/{agentId}/sessions/{sessionId}": {
        "schema": {
            "$ref": "#/entities/chatSession"
        },
        "description": "Stores metadata for each public chat session."
    },
    "/users/{userId}/agents/{agentId}/sessions/{sessionId}/messages/{messageId}": {
        "schema": {
            "$ref": "#/entities/chatMessage"
        },
        "description": "Stores all messages for a specific chat session."
    },
    "/users/{userId}/agents/{agentId}/leads/{leadId}": {
        "schema": {
            "$ref": "#/entities/lead"
        },
        "description": "Stores the leads captured for a specific agent."
    },
    "/users/{userId}/agents/{agentId}/emailSessions/{sessionId}": {
        "schema": {
            "$ref": "#/entities/emailSession"
        },
        "description": "Stores metadata for each email conversation thread."
    },
    "/users/{userId}/agents/{agentId}/emailSessions/{sessionId}/messages/{messageId}": {
        "schema": {
            "$ref": "#/entities/emailMessage"
        },
        "description": "Stores all messages for a specific email thread."
    },
    "/users/{userId}/agents/{agentId}/interactionLogs/{logId}": {
        "schema": { "$ref": "#/entities/interactionLog" },
        "description": "Stores high-level logs of agent interactions."
    },
    "/users/{userId}/agents/{agentId}/interactionLogs/{logId}/steps/{stepId}": {
        "schema": { "$ref": "#/entities/logStep" },
        "description": "Stores the detailed steps for each interaction log."
    },
    "/users/{userId}/agents/{agentId}/configurationLogs/{logId}": {
        "schema": { "$ref": "#/entities/configurationLog" },
        "description": "Stores audit logs for agent configuration changes."
    }
  }
}
